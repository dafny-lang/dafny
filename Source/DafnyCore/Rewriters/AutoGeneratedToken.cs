using System.Diagnostics.Contracts;

namespace Microsoft.Dafny;

public class AutoGeneratedToken : TokenWrapper {
  public AutoGeneratedToken(IToken wrappedToken)
    : base(wrappedToken) {
    Contract.Requires(wrappedToken != null);
  }

  public static bool Is(RangeToken rangeToken) {
    return Is(rangeToken.StartToken);
  }

  public static bool Is(IToken tok) {
    if (tok == Token.NoToken) {
      return true;
    }
    while (tok is TokenWrapper w) {
      if (w is AutoGeneratedToken) {
        return true;
      }
      tok = w.WrappedToken;
    }
    return false;
  }

  public static Expression WrapExpression(Expression expr) {
    return Expression.CreateParensExpression(expr.RangeToken.MakeAutoGenerated(), expr);
  }
}